<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Linux Survival Game</title>
<style>
  body {
    background: #000;
    color: #00ff00;
    font-family: monospace;
    margin: 0;
    padding: 20px;
  }
  .terminal {
    max-width: 900px;
    margin: auto;
    border: 2px solid #00ff00;
    padding: 15px;
    min-height: 400px;
  }
  .line {
    margin: 5px 0;
  }
  .prompt {
    color: #00ff00;
  }
  input {
    background: #000;
    color: #00ff00;
    border: none;
    outline: none;
    font-family: monospace;
    width: 50px;
  }
</style>
</head>
<body>

<div class="terminal" id="terminal"></div>

<script>
const terminal = document.getElementById("terminal");

let score = 0;
let step = 0;

const incidents = [
  {
    q: "üö® Disk is 100% full. What do you do first?",
    o: ["rm -rf /", "df -h", "shutdown -h now"],
    c: 2
  },
  {
    q: "üö® Apache service is DOWN. Correct command?",
    o: ["kill -9 httpd", "systemctl restart httpd", "reboot"],
    c: 2
  },
  {
    q: "üö® CPU usage is very high. First step?",
    o: ["top", "rm -rf /tmp", "poweroff"],
    c: 1
  },
  {
    q: "üö® SSH login failing. What will you check?",
    o: ["chmod 777 /etc/shadow", "systemctl status sshd", "delete users"],
    c: 2
  }
];

function typeLine(text, delay = 30) {
  return new Promise(resolve => {
    let i = 0;
    const line = document.createElement("div");
    line.className = "line";
    terminal.appendChild(line);

    const interval = setInterval(() => {
      line.textContent += text.charAt(i);
      i++;
      if (i >= text.length) {
        clearInterval(interval);
        resolve();
      }
      terminal.scrollTop = terminal.scrollHeight;
    }, delay);
  });
}

async function startGame() {
  terminal.innerHTML = "";
  score = 0;
  step = 0;

  await typeLine("Welcome to Linux Survival Game");
  await typeLine("Role: Production Linux Administrator");
  await typeLine("Type option number and press ENTER");
  await typeLine("-----------------------------------");
  nextIncident();
}

async function nextIncident() {
  if (step >= incidents.length) {
    await typeLine("-----------------------------------");
    await typeLine(`Game Over | Score: ${score}/${incidents.length}`);

    if (score === incidents.length)
      await typeLine("üèÜ LEGENDARY LINUX ADMIN");
    else if (score >= 2)
      await typeLine("üëç Production survived");
    else
      await typeLine("‚ö†Ô∏è Production crashed");

    await typeLine("");
    await typeLine("Refresh page to play again");
    return;
  }

  const i = incidents[step];
  await typeLine("");
  await typeLine(i.q);

  for (let x = 0; x < i.o.length; x++) {
    await typeLine(`${x + 1}) ${i.o[x]}`);
  }

  showPrompt();
}

function showPrompt() {
  const line = document.createElement("div");
  line.className = "line";
  line.innerHTML = `<span class="prompt">admin@prod ~$</span> 
                    <input id="cmd" autofocus />`;
  terminal.appendChild(line);
  terminal.scrollTop = terminal.scrollHeight;

  const input = document.getElementById("cmd");
  input.focus();

  input.addEventListener("keydown", function(e) {
    if (e.key === "Enter") {
      const choice = parseInt(input.value);
      input.disabled = true;
      checkAnswer(choice);
    }
  });
}

async function checkAnswer(choice) {
  const correct = incidents[step].c;

  if (choice === correct) {
    score++;
    await typeLine("‚úÖ Correct decision");
  } else {
    await typeLine("‚ùå Wrong decision");
  }

  step++;
  nextIncident();
}

startGame();
</script>

</body>
</html>
